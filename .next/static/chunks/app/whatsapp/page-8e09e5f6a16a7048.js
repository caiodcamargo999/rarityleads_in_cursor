(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[941],{3651:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>l});var a=s(5155),n=s(2115),r=s(5695),i=s(5060),c=s(6637),d=s(2099);function l(){let[e,t]=(0,n.useState)([]),[s,l]=(0,n.useState)(!0),[o,u]=(0,n.useState)(!1),[m,x]=(0,n.useState)({phone_number:""}),[b,h]=(0,n.useState)(null),p=(0,r.useRouter)();(0,n.useEffect)(()=>{(async()=>{let e=(0,d.b)();if(!e)return;let{data:{user:s}}=await e.auth.getUser();if(!s)return p.push("/auth");h(s);let{data:a,error:n}=await e.from("whatsapp_sessions").select("id, phone_number, status, created_at").eq("user_id",s.id).order("created_at",{ascending:!1});!n&&a&&t(a.map(e=>({id:String(e.id),phone_number:e.phone_number?String(e.phone_number):null,status:String(e.status),created_at:String(e.created_at)}))),l(!1)})()},[p]);let g=async s=>{s.preventDefault();let a=(0,d.b)();if(!a||!b)return;l(!0);let{data:n,error:r}=await a.from("whatsapp_sessions").insert({user_id:b.id,phone_number:m.phone_number,status:"inactive"}).select();!r&&n&&t([{id:String(n[0].id),phone_number:n[0].phone_number?String(n[0].phone_number):null,status:String(n[0].status),created_at:String(n[0].created_at)},...e]),u(!1),x({phone_number:""}),l(!1)},f=e=>{switch(e){case"active":return"text-green-500";case"inactive":return"text-red-500";case"connecting":return"text-yellow-500";default:return"text-secondary-text"}},_=e=>{switch(e){case"active":return"Conectado";case"inactive":return"Desconectado";case"connecting":return"Conectando...";default:return"Desconhecido"}};return(0,a.jsxs)("div",{className:"min-h-screen bg-main-bg flex",children:[(0,a.jsx)(i.A,{user:b?{name:b.name,email:b.email}:void 0,onProfileClick:()=>{}}),(0,a.jsxs)("main",{className:"flex-1 lg:ml-64 p-6",children:[(0,a.jsxs)("header",{className:"mb-8 flex items-center justify-between",children:[(0,a.jsx)("h1",{className:"text-3xl font-medium text-primary-text",children:"WhatsApp"}),(0,a.jsx)("button",{className:"btn",onClick:()=>u(!0),children:"+ Nova Sess\xe3o"})]}),o&&(0,a.jsxs)("form",{onSubmit:g,className:"bg-card-bg border border-border rounded-card p-6 mb-8 flex flex-col gap-4 max-w-md",children:[(0,a.jsx)("input",{className:"bg-main-bg border border-border rounded-btn px-4 py-2 text-primary-text",placeholder:"N\xfamero do WhatsApp (ex: 5511999999999)",value:m.phone_number,onChange:e=>x({phone_number:e.target.value}),required:!0}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"submit",className:"btn",children:"Salvar"}),(0,a.jsx)("button",{type:"button",className:"btn",onClick:()=>u(!1),children:"Cancelar"})]})]}),(0,a.jsx)("section",{children:s?(0,a.jsx)("div",{className:"text-secondary-text",children:"Carregando..."}):0===e.length?(0,a.jsx)("div",{className:"text-secondary-text",children:"Nenhuma sess\xe3o WhatsApp configurada."}):(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(e=>(0,a.jsxs)("div",{className:"bg-card-bg border border-border rounded-card p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,a.jsx)("div",{className:"font-medium text-primary-text",children:e.phone_number||"(N\xfamero n\xe3o informado)"}),(0,a.jsx)("div",{className:"text-sm ".concat(f(e.status)),children:_(e.status)})]}),(0,a.jsxs)("div",{className:"text-xs text-secondary-text mb-4",children:["Criado em: ",new Date(e.created_at).toLocaleString()]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{className:"btn text-sm",children:"Conectar"}),(0,a.jsx)("button",{className:"btn text-sm",children:"Configurar"})]})]},e.id))})})]}),(0,a.jsx)(c.A,{user:b?{name:b.name,email:b.email}:void 0,isVisible:!0,onClose:()=>{},onLogout:()=>{}})]})}},7841:(e,t,s)=>{Promise.resolve().then(s.bind(s,3651))}},e=>{var t=t=>e(e.s=t);e.O(0,[874,825,956,441,684,358],()=>t(7841)),_N_E=e.O()}]);